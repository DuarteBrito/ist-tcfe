*
* NGSPICE simulation script
* Lab3
*

* forces current values to be saved
.options savecurrents

******************************************

*Va supply voltage
Va 0 1 0 SIN(0 230 50 0 0)

*transformer
F1 1 0 E1 17
E1 2 0 1 0 0.05882352941

*Full-wave rectifier circuit
* Diode 1
D1 2 3 Default

* Diode 2
D2 0 3 Default

* Diode 3
D3 4 0 Default

* Diode 4
D4 4 2 Default

*Envelope Detector
* Capacitor
Ca 3 4 0.0000005

*Voltage Regulator
* R1
R1 3 5 0.5k

* Diode 5
D5 5 6 Default

* Diode 6
D5 6 7 Default

* Diode 7
D5 7 8 Default

* Diode 8
D5 8 9 Default

* Diode 9
D5 9 10 Default

* Diode 10
D5 10 11 Default

* Diode 11
D5 11 12 Default

* Diode 12
D5 12 13 Default

* Diode 13
D5 13 14 Default

* Diode 14
D5 14 15 Default

* Diode 15
D5 15 16 Default

* Diode 16
D5 16 17 Default

* Diode 17
D5 17 18 Default

* Diode 18
D5 18 19 Default

* Diode 19
D5 19 20 Default

* Diode 20
D5 20 21 Default

* Diode 21
D5 21 22 Default

* Diode 22
D5 22 4 Default

.model Default D

.op

.end

.control

*makes plots in color
set hcopypscolor=0
set color0=white
set color1=black
set color2=red
set color3=blue
set color4=violet
set color5=rgb:3/8/0
set color6=rgb:4/0/0

echo "********************************************"

echo  "Transient analysis"

echo "********************************************"
 
tran 0.0001 1 0.8

echo "info_TAB"
print mean(v(5)-v(4))
*print mean(v(5)-v(4)-12)
print maximum(v(5)-v(4))-minimum(v(5)-v(4))
echo "info_END"

*hardcopy outputvoltage.ps v(2) (v(3)-v(4))
hardcopy outputvoltage.ps v(2) v(3)-v(4)

echo outputvoltage_FIG

*echo "********************************************"
*echo  "Transient analysis"
*echo "********************************************"

hardcopy detail.ps v(5)-v(4)-12
echo detail_FIG

quit

.endc


